# Line Searchèª¿æŸ»çµæœ

**èª¿æŸ»æ—¥:** 2025-10-27
**è¨­å®š:** nCells=75, tolerance=2e-1, dt=1.5e-4, moderate profile

---

## ğŸ“Š èª¿æŸ»çµæœã‚µãƒãƒªãƒ¼

### ğŸ”´ é‡å¤§ãªç™ºè¦‹

**Newtonæ–¹å‘ã®æ€¥æ¿€ãªå´©å£Š:**
- iter=0: ||Î”|| = 2.17e-04 âœ… æ­£å¸¸
- iter=1: ||Î”|| = 8.35e-07 ğŸ”´ **260å€ç¸®å°**
- iter=2: ||Î”|| = 6.27e-07 ğŸ”´ **ã•ã‚‰ã«ç¸®å°**

**Line searchã®æŒ™å‹•:**
- iter=0: Î±=1.0ã§74.9%æ”¹å–„ âœ… æ­£å¸¸
- iter=1ä»¥é™: Î±=1.0ã§æ‚ªåŒ–ã€Î±=0.25ã§ã‚ãšã‹ãªæ”¹å–„ã®ã¿ âš ï¸

**çµè«–:** å•é¡Œã¯ã€ŒÎ±ã®é£½å’Œã€ã§ã¯ãªãã€**Newtonæ–¹å‘||Î”||ã®ç•°å¸¸ãªç¸®å°**

---

## ğŸ“‹ ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã”ã¨ã®è©³ç´°

### Iteration 0ï¼ˆåˆå›ï¼‰

**çŠ¶æ…‹:**
```
residualNorm: 2.03
xScaled range: [0.0, 1.5]
residualScaled range: [-0.513, 4.419]

residualScaledæˆåˆ†:
  Ti: [-0.513, 0.987]
  Te: [3.675, 4.419]  â† æ”¯é…çš„
  ne: [-0.003, 0.025]
```

**Jacobian:**
```
Îº = 3.36e+04
Ïƒ_max = 3.52e+07
Ïƒ_min = 1.05e+03  âœ… ç‰¹ç•°ã§ã¯ãªã„

J_TiTi: [0.0, 1.76e+07]
J_TeTe: [0.0, 1.76e+07]
J_nene: [0.0, 6526]
```

**Newtonæ–¹å‘:**
```
||Î”|| = 2.17e-04
Î” range: [-4.03e-04, 2.16e-06]
```

**Line search:**
```
Î±=1.0 â†’ residualNorm=0.510 (74.9% improvement) âœ… Accepted
```

**è©•ä¾¡:** âœ… ã™ã¹ã¦æ­£å¸¸

---

### Iteration 1

**çŠ¶æ…‹:**
```
residualNorm: 0.510 (å‰å›ã‹ã‚‰74.9%æ”¹å–„)
xScaled range: [6.555e-11, 1.4997]  â† æœ€å°å€¤ãŒ0â†’6e-11
```

**Jacobian:**
```
Îº = 3.36e+04 (å¤‰åŒ–ãªã—)
Ïƒ_max = 3.52e+07
Ïƒ_min = 1.05e+03 (å¤‰åŒ–ãªã—)
```

**Newtonæ–¹å‘:**
```
||Î”|| = 8.35e-07  ğŸ”´ å‰å›ã®2.17e-04ã‹ã‚‰260å€ç¸®å°ï¼
Î” range: [-1.96e-06, 1.79e-06]
```

**Line search:**
```
Î±=1.0 â†’ residualNorm=0.526 (-3.2% æ‚ªåŒ–)
Î±=0.5 â†’ residualNorm=0.569 (-11.6% æ‚ªåŒ–)
Î±=0.25 â†’ residualNorm=0.478 (6.2% improvement) âœ… Accepted
```

**è©•ä¾¡:** ğŸ”´ ||Î”||ã®ç•°å¸¸ãªç¸®å°ã€Î±=1.0ã§æ‚ªåŒ–

---

### Iteration 2

**çŠ¶æ…‹:**
```
residualNorm: 0.478
xScaled range: [6.049e-11, 1.4997]  â† ã»ã¼å¤‰åŒ–ãªã—
```

**Jacobian:**
```
Îº = 3.36e+04 (å¤‰åŒ–ãªã—)
```

**Newtonæ–¹å‘:**
```
||Î”|| = 6.27e-07  ğŸ”´ ã•ã‚‰ã«ç¸®å°
Î” range: [-1.48e-06, 1.36e-06]
```

**Line search:**
```
Î±=1.0 â†’ residualNorm=0.525 (-9.9% æ‚ªåŒ–)
Î±=0.5 â†’ residualNorm=0.541 (-13.1% æ‚ªåŒ–)
Î±=0.25 â†’ residualNorm=0.478 (0.0% å¤‰åŒ–ãªã—) âš ï¸ åœæ»é–‹å§‹
```

**è©•ä¾¡:** ğŸ”´ ||Î”||ã•ã‚‰ã«ç¸®å°ã€Î±=0.25ã§ã‚‚æ”¹å–„ã‚¼ãƒ­

---

## ğŸ”¬ è©³ç´°åˆ†æ

### 1. Newtonæ–¹å‘ã®å´©å£Š

**è¦³æ¸¬ã•ã‚ŒãŸç¾è±¡:**

| Iteration | ||Î”|| | å‰å›æ¯” | è©•ä¾¡ |
|-----------|-------|--------|------|
| 0 | 2.17e-04 | - | âœ… æ­£å¸¸ |
| 1 | 8.35e-07 | 1/260 | ğŸ”´ ç•°å¸¸ |
| 2 | 6.27e-07 | 0.75 | ğŸ”´ ã•ã‚‰ã«ç¸®å° |

**å•é¡Œ:**
- iter=0â†’1ã§||Î”||ãŒ**260å€**ç¸®å°
- Jacobianã®æ¡ä»¶æ•°Îºã¯å¤‰åŒ–ã—ã¦ã„ãªã„ï¼ˆ3.36e+04ã§ä¸€å®šï¼‰
- Ïƒ_minã‚‚å¥å…¨ï¼ˆ1.05e+03ï¼‰

**ä»®èª¬:**

#### ä»®èª¬A: residualãŒå°ã•ã™ãã‚‹ï¼Ÿ
```
iter=0: residualNorm = 2.03 â†’ Î” = 2.17e-04
iter=1: residualNorm = 0.510 â†’ Î” = 8.35e-07
```

æ¯”ç‡: 2.03/0.510 = 4å€ã®æ¸›å°‘
||Î”||: 2.17e-04 / 8.35e-07 = 260å€ã®æ¸›å°‘

**ä¸æ•´åˆ:** residualã®æ¸›å°‘ï¼ˆ4å€ï¼‰ã«å¯¾ã—ã¦||Î”||ã®æ¸›å°‘ï¼ˆ260å€ï¼‰ãŒå¤§ãã™ãã‚‹

#### ä»®èª¬B: ç·šå½¢ã‚·ã‚¹ãƒ†ãƒ ã®ç²¾åº¦å•é¡Œ

ç·šå½¢ã‚½ãƒ«ãƒãƒ¼ãŒè¿”ã™Î”ã¯ `J * Î” = -R` ã‚’æº€ãŸã™ã¯ãšã ãŒã€
å®Ÿéš›ã«æº€ãŸã—ã¦ã„ã‚‹ã‹æœªç¢ºèªã€‚

**è¦ç¢ºèª:** `||J*Î” + R|| / ||R||` < 1e-6?

#### ä»®èª¬C: Jacobianã®å“è³ªåŠ£åŒ–

iter=1ã§ã¯çŠ¶æ…‹ãŒå¤‰åŒ–ã—ã¦Jacobianã®æ§‹é€ ãŒå¤‰ã‚ã£ãŸå¯èƒ½æ€§ï¼š
- æ¡ä»¶æ•°Îºã¯åŒã˜ã ãŒã€æˆåˆ†ã®åˆ†å¸ƒãŒå¤‰ã‚ã£ãŸï¼Ÿ
- ç‰¹å®šã®å¤‰æ•°ï¼ˆTe?ï¼‰ã®æ„Ÿåº¦ãŒæ¥µç«¯ã«å°ã•ããªã£ãŸï¼Ÿ

---

### 2. Line searchã§ã®Î±=1.0å¤±æ•—

**iter=0 vs iter=1ã®æ¯”è¼ƒ:**

| Iteration | Î±=1.0ã®çµæœ | è©•ä¾¡ |
|-----------|-------------|------|
| 0 | 74.9% improvement | âœ… æˆåŠŸ |
| 1 | -3.2% (æ‚ªåŒ–) | âŒ å¤±æ•— |
| 2 | -9.9% (æ‚ªåŒ–) | âŒ å¤±æ•— |

**ãƒ‘ã‚¿ãƒ¼ãƒ³:**
- iter=0: å¤§ããªÎ” (2.17e-04) Ã— Î±=1.0 â†’ æˆåŠŸ
- iter=1: å°ã•ãªÎ” (8.35e-07) Ã— Î±=1.0 â†’ å¤±æ•—

**ä»®èª¬:**

#### ä»®èª¬D: Newtonæ–¹å‘ã®å‘ããŒé–“é•ã£ã¦ã„ã‚‹

ã‚‚ã—Î”ã®**å‘ã**ãŒé™ä¸‹æ–¹å‘ã§ãªã„å ´åˆï¼š
```
Î” Â· (-gradient) < 0  â† é™ä¸‹æ–¹å‘ã§ã¯ãªã„
```

Î±=1.0ã§æ®‹å·®ãŒæ‚ªåŒ–ã™ã‚‹ã®ã¯ã€æ–¹å‘ãŒé–“é•ã£ã¦ã„ã‚‹ã‹ã‚‰ï¼Ÿ

**è¦ç¢ºèª:**
- `Î” Â· (-R)` > 0ã‹ï¼Ÿï¼ˆé™ä¸‹æ€§ï¼‰
- Gradientã®è¨ˆç®—ï¼ˆresidual = R ãªã®ã§ -R ãŒé™ä¸‹æ–¹å‘ï¼‰

#### ä»®èª¬E: éç·šå½¢æ€§ãŒå¼·ã„é ˜åŸŸ

iter=0ã§å¤§ããå‹•ã„ãŸçµæœã€éç·šå½¢æ€§ã®å¼·ã„é ˜åŸŸã«å…¥ã£ãŸï¼Ÿ
- è§£ã®è¿‘å‚ã§ã¯ç·šå½¢è¿‘ä¼¼ãŒæœ‰åŠ¹
- é ã„å ´æ‰€ã§ã¯ç·šå½¢è¿‘ä¼¼ãŒç ´ç¶»

ã—ã‹ã—ã€iter=1ã®Î”ã¯éå¸¸ã«å°ã•ã„ï¼ˆ8.35e-07ï¼‰ã®ã§ã€
ç·šå½¢è¿‘ä¼¼ãŒç ´ç¶»ã™ã‚‹ã»ã©å‹•ã„ã¦ã„ãªã„ã¯ãšã€‚

---

### 3. residualScaledã®æˆåˆ†åˆ†æ

**iter=0ã®residualæˆåˆ†:**

```
Ti: [-0.513, 0.987]   â†’ max = 0.987
Te: [3.675, 4.419]    â†’ max = 4.419  â† æ”¯é…çš„
ne: [-0.003, 0.025]   â†’ max = 0.025
```

**ã‚¹ã‚±ãƒ¼ãƒ«æ¯”:**
```
Te / Ti = 4.419 / 0.987 = 4.5å€
Te / ne = 4.419 / 0.025 = 177å€
```

**å•é¡Œ:**
- Teï¼ˆé›»å­æ¸©åº¦ï¼‰ã®æ®‹å·®ãŒä»–ã®å¤‰æ•°ã‚ˆã‚Š1-2æ¡å¤§ãã„
- residualNormã¯Teæˆåˆ†ã«æ”¯é…ã•ã‚Œã¦ã„ã‚‹
- Ti, neã®æ®‹å·®ã¯å°ã•ã„ãŒã€TeãŒåæŸã—ã¦ã„ãªã„

**ç‰©ç†çš„è§£é‡ˆ:**
- Teæ–¹ç¨‹å¼ã«å¤§ããªã‚½ãƒ¼ã‚¹é …ï¼ˆåŠ ç†±æºï¼‰ãŒã‚ã‚‹ãŸã‚æ®‹å·®ãŒå¤§ãã„ï¼Ÿ
- Ti, neã¯æ¯”è¼ƒçš„ãƒãƒ©ãƒ³ã‚¹ã—ã¦ã„ã‚‹ãŒTeã ã‘ä¸å‡è¡¡ï¼Ÿ

---

### 4. xScaledã®ç¯„å›²åˆ†æ

**å„ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®xScaled:**

```
iter=0: [0.0, 1.5]
iter=1: [6.555e-11, 1.4997]
iter=2: [6.049e-11, 1.4997]
```

**æœ€å°å€¤ã®å¤‰åŒ–:**
```
iter=0: 0.0
iter=1: 6.555e-11  â† ã»ã¼ã‚¼ãƒ­ã ãŒå³å¯†ã«ã¯ã‚¼ãƒ­ã§ã¯ãªã„
iter=2: 6.049e-11
```

**æ¨æ¸¬:**
- æœ€å°å€¤ã¯psiï¼ˆãƒãƒ­ã‚¤ãƒ€ãƒ«ç£æŸï¼‰ã®å¢ƒç•Œå€¤ï¼Ÿ
- å¢ƒç•Œæ¡ä»¶ psi=0 ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãŒã€æ•°å€¤çš„ã«ã‚¼ãƒ­ã§ã¯ãªã„
- 6e-11ã¯æµ®å‹•å°æ•°ç‚¹èª¤å·®ã®ç¯„å›²

**æœ€å¤§å€¤ã®å¤‰åŒ–:**
```
iter=0: 1.5     (Tiã®ãƒ”ãƒ¼ã‚¯å€¤ã€1500 eV / 1000 eV = 1.5)
iter=1: 1.4997  â† ã‚ãšã‹ã«æ¸›å°‘
iter=2: 1.4997  â† ã»ã¼å¤‰åŒ–ãªã—
```

**è¦³æ¸¬:**
- iter=0â†’1ã§ Tiãƒ”ãƒ¼ã‚¯å€¤ãŒ 1.5 â†’ 1.4997ï¼ˆ0.02%æ¸›å°‘ï¼‰
- ã“ã‚Œã¯ç‰©ç†çš„ã«ã¯ 1500 eV â†’ 1499.7 eVï¼ˆ0.3 eVæ¸›å°‘ï¼‰
- éå¸¸ã«å°ã•ãªå¤‰åŒ–

---

## ğŸ¯ æ ¹æœ¬åŸå› ã®ä»®èª¬

### æœ€æœ‰åŠ›ä»®èª¬: Newtonæ–¹å‘ã®ç²¾åº¦åŠ£åŒ–

**è¨¼æ‹ :**
1. âœ… Jacobianè‡ªä½“ã¯å¥å…¨ï¼ˆÎº=3.36e+04ã€Ïƒ_min=1.05e+03ï¼‰
2. âœ… ç·šå½¢ã‚½ãƒ«ãƒãƒ¼ã¯æˆåŠŸã—ã¦ã„ã‚‹ï¼ˆDirect solver succeededï¼‰
3. ğŸ”´ ã—ã‹ã—||Î”||ãŒç•°å¸¸ã«å°ã•ã„
4. ğŸ”´ Î±=1.0ã§æ‚ªåŒ–ã™ã‚‹

**å¯èƒ½æ€§ã®ã‚ã‚‹åŸå› :**

#### åŸå› 1: residualã®æˆåˆ†ãƒãƒ©ãƒ³ã‚¹

Teæ®‹å·®ãŒæ”¯é…çš„ï¼ˆ177å€ï¼‰:
```
Te: 4.419
ne: 0.025
```

Jacobianã‚’è§£ãéš›ã€Teæˆåˆ†ãŒæ”¯é…çš„ã ã¨ï¼š
- Î”ã®æ›´æ–°ãŒTeä¸­å¿ƒã«ãªã‚‹
- Ti, neã®æ›´æ–°ãŒä¸ååˆ†
- å…¨ä½“ã¨ã—ã¦åæŸãŒé…ã„

#### åŸå› 2: Jacobianæˆåˆ†ã®ã‚¹ã‚±ãƒ¼ãƒ«å·®ï¼ˆ2700å€ï¼‰

ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ã¯ã€Œç‰©ç†çš„ã«å¦¥å½“ã€ã¨æŒ‡æ‘˜ã•ã‚ŒãŸãŒã€
å®Ÿéš›ã®åæŸã«ã¯å½±éŸ¿ã—ã¦ã„ã‚‹å¯èƒ½æ€§ï¼š

```
J_TiTi ~ 1.76e+07
J_nene ~ 6.5e+03
æ¯”ç‡: 2700å€
```

â†’ Tiæ–¹å‘ã®æ„Ÿåº¦ãŒé«˜ãã€neæ–¹å‘ã®æ„Ÿåº¦ãŒä½ã„
â†’ Tiä¸­å¿ƒã®æ›´æ–°ã«ãªã‚Šã€neãŒå–ã‚Šæ®‹ã•ã‚Œã‚‹ï¼Ÿ

#### åŸå› 3: ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®ä¸å‡ä¸€

referenceStateã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°:
```
Ti: 1000 eV
Te: 1000 eV
ne: 1e+20 mâ»Â³
```

ã—ã‹ã—residualã«ã¯ä¸å‡ä¸€:
```
residual_Ti: O(1)
residual_Te: O(4)  â† 4å€å¤§ãã„
residual_ne: O(0.01)
```

â†’ referenceStateã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¯xã«ã¯æœ‰åŠ¹ã ãŒã€residualã«ã¯ä¸ååˆ†ï¼Ÿ

---

## ğŸ“‹ æ¬¡ã®èª¿æŸ»ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼ï¼‰

### Phase 1: Newtonæ–¹å‘ã®å¦¥å½“æ€§æ¤œè¨¼

**ç›®çš„:** Î”ã®å‘ãã¨å¤§ãã•ãŒå¦¥å½“ã‹ç¢ºèª

**å®Ÿè£…å†…å®¹:**

1. **é™ä¸‹æ€§ã®ç¢ºèª:**
```swift
// iter=0ã§ã®ãƒ­ã‚°ã«è¿½åŠ 
let descent_check = (deltaScaled * (-residualScaled)).sum()
print("[NR-CHECK] Descent condition: Î”Â·(-R) = \(descent_check.item(Float.self))")
// Should be > 0 for valid descent direction
```

2. **ç·šå½¢ã‚½ãƒ«ãƒãƒ¼ç²¾åº¦:**
```swift
let linear_residual = jacobianScaled.matmul(deltaScaled) + residualScaled
let linear_error = MLX.norm(linear_residual) / MLX.norm(residualScaled)
print("[NR-CHECK] Linear solve error: ||J*Î” + R|| / ||R|| = \(linear_error.item(Float.self))")
// Should be < 1e-6
```

3. **Î”ã®æˆåˆ†åˆ†è§£:**
```swift
// iter=0ã§ã®Î”ã®å¤‰æ•°ã”ã¨ã®å¤§ãã•
let delta_Ti = deltaScaled[0..<nCells]
let delta_Te = deltaScaled[nCells..<(2*nCells)]
let delta_ne = deltaScaled[(2*nCells)..<(3*nCells)]

print("[NR-CHECK] ||Î”_Ti|| = \(MLX.norm(delta_Ti).item(Float.self))")
print("[NR-CHECK] ||Î”_Te|| = \(MLX.norm(delta_Te).item(Float.self))")
print("[NR-CHECK] ||Î”_ne|| = \(MLX.norm(delta_ne).item(Float.self))")
```

**æœŸå¾…ã•ã‚Œã‚‹çµæœ:**
- Descent condition > 0ï¼ˆé™ä¸‹æ–¹å‘ï¼‰
- Linear error < 1e-6ï¼ˆç·šå½¢ã‚½ãƒ«ãƒãƒ¼ç²¾åº¦ï¼‰
- Î”ã®æˆåˆ†ãƒãƒ©ãƒ³ã‚¹ç¢ºèª

---

### Phase 2: residualæˆåˆ†ã®è¿½è·¡

**ç›®çš„:** Teæ®‹å·®ãŒæ”¯é…çš„ãªç†ç”±ã‚’ç‰¹å®š

**å®Ÿè£…å†…å®¹:**

1. **residualã®å¤‰æ•°ã”ã¨ã®ãƒãƒ«ãƒ :**
```swift
// å„ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§
let residualNorm_Ti = MLX.norm(residual_Ti).item(Float.self)
let residualNorm_Te = MLX.norm(residual_Te).item(Float.self)
let residualNorm_ne = MLX.norm(residual_ne).item(Float.self)

print("[NR-RESIDUAL] ||R_Ti|| = \(residualNorm_Ti)")
print("[NR-RESIDUAL] ||R_Te|| = \(residualNorm_Te)")
print("[NR-RESIDUAL] ||R_ne|| = \(residualNorm_ne)")
print("[NR-RESIDUAL] Total = \(residualNorm)")
```

2. **æ”¹å–„ç‡ã®å¤‰æ•°ã”ã¨è¿½è·¡:**
```swift
// iter=1ã§ã®å„å¤‰æ•°ã®æ”¹å–„ç‡
let improvement_Ti = (residualNorm_Ti_old - residualNorm_Ti) / residualNorm_Ti_old
print("[NR-RESIDUAL] Ti improvement: \(improvement_Ti * 100)%")
// Te, neã‚‚åŒæ§˜
```

**æœŸå¾…ã•ã‚Œã‚‹çµæœ:**
- Teã ã‘åæŸãŒé…ã„ã®ã‹ç¢ºèª
- Ti, neã¯åæŸã—ã¦ã„ã‚‹ãŒTeãŒåœæ»ï¼Ÿ

---

### Phase 3: Î±=1.0å¤±æ•—ã®è©³ç´°èª¿æŸ»

**ç›®çš„:** ãªãœÎ±=1.0ã§æ‚ªåŒ–ã™ã‚‹ã‹ç‰¹å®š

**å®Ÿè£…å†…å®¹:**

1. **Î±=1.0ã§ã®residualæˆåˆ†:**
```swift
// Line searchå†…ã§
if alpha == 1.0 && iter > 0 {
    // Î±=1.0ã§ã®å„å¤‰æ•°ã®residual
    print("[LS-DETAIL] Î±=1.0: residual_Ti range")
    print("[LS-DETAIL] Î±=1.0: residual_Te range")
    print("[LS-DETAIL] Î±=1.0: residual_ne range")
}
```

2. **äºˆæ¸¬ vs å®Ÿéš›:**
```swift
// 1æ¬¡è¿‘ä¼¼ã§ã®äºˆæ¸¬: f(x + Î”) â‰ˆ f(x) + âˆ‡fÂ·Î”
let predicted_improvement = (residualScaled * deltaScaled).sum()
print("[NR-PREDICT] Predicted Î”f = \(predicted_improvement.item(Float.self))")
// å®Ÿéš›ã®æ”¹å–„ã¨æ¯”è¼ƒ
```

**æœŸå¾…ã•ã‚Œã‚‹çµæœ:**
- ã©ã®å¤‰æ•°ãŒæ‚ªåŒ–ã—ã¦ã„ã‚‹ã‹ç‰¹å®š
- ç·šå½¢è¿‘ä¼¼ã®æœ‰åŠ¹æ€§ç¢ºèª

---

## ğŸ’¡ å¯¾ç­–ã®æ–¹å‘æ€§ï¼ˆä»®èª¬ï¼‰

### Option A: residualæˆåˆ†ã”ã¨ã®é‡ã¿ä»˜ã‘

**ã‚‚ã—Teæ®‹å·®ãŒæ”¯é…çš„ãªã‚‰:**

```swift
// residualã«å¤‰æ•°ã”ã¨ã®é‡ã¿ã‚’é©ç”¨
let weight_Ti = 1.0
let weight_Te = 0.25  // Teã‚’æŠ‘ãˆã‚‹
let weight_ne = 1.0

let residualWeighted = concat([
    residual_Ti * weight_Ti,
    residual_Te * weight_Te,
    residual_ne * weight_ne,
    residual_psi
])
```

**æœŸå¾…åŠ¹æœ:**
- Teæ®‹å·®ã®å½±éŸ¿ã‚’æŠ‘ãˆã€Ti, neã‚‚ãƒãƒ©ãƒ³ã‚¹ã‚ˆãåæŸ

**ãƒªã‚¹ã‚¯:**
- Teã®åæŸãŒé…ããªã‚‹å¯èƒ½æ€§
- ç‰©ç†çš„ãªå¦¥å½“æ€§ã®æ¤œè¨¼ãŒå¿…è¦

---

### Option B: é©å¿œçš„ãƒ€ãƒ³ãƒ”ãƒ³ã‚°

**ã‚‚ã—Î±=1.0ãŒå¤§ãã™ãã‚‹ãªã‚‰:**

```swift
// Newtonæ–¹å‘ã®å¤§ãã•ã«åŸºã¥ã„ã¦åˆæœŸÎ±ã‚’èª¿æ•´
let adaptive_alpha = min(1.0, 1e-3 / deltaNorm)
```

**æœŸå¾…åŠ¹æœ:**
- iter=1ä»¥é™ã§ã‚‚é©åˆ‡ãªÎ±ã‹ã‚‰é–‹å§‹
- éåº¦ãªæ›´æ–°ã‚’é˜²ã

---

### Option C: Trust-Regionæ³•ã¸ã®åˆ‡ã‚Šæ›¿ãˆ

**ã‚‚ã—Line searchãŒæœ¬è³ªçš„ã«ä¸é©åˆ‡ãªã‚‰:**

Trust-Regionæ³•:
```
min ||Î”||  s.t. ||J*Î” + R|| â‰¤ Îµ and ||Î”|| â‰¤ trust_radius
```

**æœŸå¾…åŠ¹æœ:**
- Î”ã®å¤§ãã•ã‚’ç›´æ¥åˆ¶å¾¡
- Î±ã®é£½å’Œå•é¡Œã‚’å›é¿

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:**
- å®Ÿè£…ãŒè¤‡é›‘
- trust_radiusã®èª¿æ•´ãŒå¿…è¦

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼

| Metric | iter=0 | iter=1 | iter=2 | è©•ä¾¡ |
|--------|--------|--------|--------|------|
| residualNorm | 2.03 | 0.510 | 0.478 | âš ï¸ åœæ»å‚¾å‘ |
| \|\|Î”\|\| | 2.17e-04 | 8.35e-07 | 6.27e-07 | ğŸ”´ ç•°å¸¸ç¸®å° |
| Î± (accepted) | 1.0 | 0.25 | 0.25 | âš ï¸ é£½å’Œ |
| Îº | 3.36e+04 | 3.36e+04 | 3.36e+04 | âœ… å®‰å®š |
| residual_Te (max) | 4.419 | ? | ? | âš ï¸ æ”¯é…çš„ |

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **PRECONDITIONER_SUSPENDED_REVIEW.md** - Preconditionerä¿ç•™ã®ç†ç”±
- **INVESTIGATION_RESULTS.md** - Jacobianã‚¹ã‚±ãƒ¼ãƒ«å·®ã®èª¿æŸ»
- **NEWTON_SOLVER_STATUS.md** - å…¨ä½“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

---

**æœ€çµ‚æ›´æ–°:** 2025-10-27
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:** æ ¹æœ¬åŸå› ã®ä»®èª¬ç‰¹å®šã€æ¬¡ã®èª¿æŸ»ã‚¹ãƒ†ãƒƒãƒ—ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡
**å„ªå…ˆåº¦:** æœ€é«˜ï¼ˆåæŸå•é¡Œã®æ ¹æœ¬åŸå› ï¼‰
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:** Phase 1-3ã®ãƒ­ã‚°å®Ÿè£…ã«ã¤ã„ã¦æ‰¿èªã‚’å¾—ã‚‹
